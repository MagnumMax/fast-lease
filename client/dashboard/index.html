<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dubai Fast Lease — Client Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            brand: {
              500: '#2563eb',
              600: '#1d4ed8',
            },
          },
        },
      },
    };
  </script>
  <link rel="stylesheet" href="../../assets/style.css" />
</head>
<body class="bg-slate-50 font-sans text-slate-900">
  <div class="min-h-screen lg:flex">
    <aside id="sidebar" class="hidden w-72 border-r border-slate-200 bg-white lg:flex"></aside>
    <div class="flex-1">
      <header id="page-header" class="border-b border-slate-200 bg-white/80 px-6 py-5 backdrop-blur"></header>
      <main class="bg-slate-50">
        <div class="mx-auto flex w-full max-w-6xl flex-col gap-6 lg:ml-0 lg:mr-auto">
          <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
            <h2 class="mt-2 text-xl font-semibold text-slate-900">Application Status</h2>
            <div class="mt-6" id="application-timeline" aria-label="Application steps" role="region"></div>
          </section>
          <!-- Deal Component -->
          <div id="deal-component"></div>

          <!-- Key info + Combined documents -->
          <section class="grid gap-6 md:grid-cols-2">
            <div id="key-information-component"></div>
            <div id="documents-component"></div>
          </section>
          <!-- What to upload block removed by requirement -->
          <section class="grid gap-6 md:grid-cols-2">
            
            <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm md:col-span-2">
              <div class="flex items-center justify-between">
                <div>
                  <h2 class="mt-2 text-xl font-semibold text-slate-900">Notifications</h2>
                </div>
              </div>
              <div class="mt-4 space-y-3" id="notifications" aria-live="polite" aria-atomic="false"></div>
            </article>

            
          </section>
        </div>
      </main>
    </div>
  </div>

  <!-- Mobile Bottom Navigation -->
  <nav id="mobile-bottom-nav" class="mobile-bottom-nav"></nav>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script type="module">
    async function getShared(basePath) {
      
      const sharedMod = await import(`${basePath}/shared.js`);
      return { ...sharedMod };
    }

    // Import components
    const { mountDealComponent, updateDealKPIs } = await import('../../components/deal-component.js');
    const { mountKeyInformationComponent } = await import('../../components/key-information-component.js');
    const { mountDocumentsComponent } = await import('../../components/documents-component.js');

    const shared = await getShared('../../assets');
    const { mountSidebar, mountHeader, mountMobileBottomNav, mountTimeline, renderNotifications, formatCurrency, formatDate, applyIcons, clientNav, loadPricing } = shared;

    const basePath = '../..';
    mountSidebar({
      containerId: 'sidebar',
      role: 'Client',
      items: clientNav,
      activePath: '/client/dashboard/index.html',
      basePath,
    });

    mountHeader({
      containerId: 'page-header',
      title: 'Client Dashboard',
      breadcrumbs: ['Client', 'Overview'],
      basePath,
    });

    // Mount mobile bottom navigation
    mountMobileBottomNav({
      containerId: 'mobile-bottom-nav',
      items: clientNav,
      activePath: '/client/dashboard/index.html',
      basePath,
    });

    const timelineSteps = [
      {
        title: 'Application submitted',
        description: 'KYC verification completed. Contact details confirmed.',
        state: 'is-done',
      },
      {
        title: 'AI document analysis',
        description: 'Emirates ID and salary certificate files successfully recognized.',
        state: 'is-done',
      },
      {
        title: 'Pre-delivery inspection',
        description: 'Manager coordinates with the service station to confirm the report.',
        state: 'is-active',
        meta: '<span class="mt-2 inline-flex items-center gap-2 rounded-full bg-amber-50 px-3 py-1 text-xs font-medium text-amber-600"><i data-lucide="alert-octagon" class="h-3.5 w-3.5"></i>Registration Card photo required</span>'
      },
      {
        title: 'Contract signing',
        description: 'Lease agreement generated. We’ll notify you when it’s ready for signature.',
      },
    ];

    mountTimeline({ containerId: 'application-timeline', steps: timelineSteps });

    // Mount Deal Component
    mountDealComponent('deal-component');

    // KPI from pricing (single active deal)
    const pricing = await loadPricing('../../assets');
    const carId = 'rolls-royce-cullinan';
    const monthly = pricing[carId]?.monthly ?? 3260;
    const buyout = 45000; // Fixed due amount value
    const nextPayment = '2025-11-15';
    
    // Update Deal KPIs
    updateDealKPIs(formatCurrency(monthly, 'AED'), formatDate(nextPayment), formatCurrency(buyout, 'AED'));

    // Mount Key Information Component
    mountKeyInformationComponent('key-information-component');

    // Mount Documents Component
    mountDocumentsComponent('documents-component');

    const notifications = [
      {
        title: 'Service report finalization',
        description: 'Aurora service is ready to publish diagnostic results.',
        icon: 'wrench',
        time: '15 min ago',
      },
      {
        title: 'Contract signing',
        description: 'Lease agreement generated. We will notify you when it is ready for signature.',
        icon: 'file-text',
        time: '1 hour ago',
      },
      {
        title: 'Potential overdue',
        description: 'Upcoming payment falls on a weekend. We proposed automatic debit on Friday.',
        icon: 'calendar-clock',
        time: 'Yesterday',
      },
    ];

    renderNotifications({ containerId: 'notifications', items: notifications });

    // Recommendations block removed by requirement

    // Schedule consultation button removed by requirement

    // Apply global focus-visible styles for interactive elements
    const applyFocusStyles = () => {
      const selectors = ['a', 'button', '[role="button"]', 'input', 'select', 'textarea'];
      const elements = document.querySelectorAll(selectors.join(','));
      elements.forEach((el) => {
        el.classList.add('focus:outline-none', 'focus:ring-2', 'focus:ring-slate-400', 'focus:ring-offset-2');
      });
    };

    // Initialize icons after all elements load
    setTimeout(() => {
      applyIcons();
      applyFocusStyles();
    }, 100);
  </script>
</body>
</html>
