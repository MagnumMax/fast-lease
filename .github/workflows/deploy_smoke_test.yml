name: Deployment Smoke Tests

on:
  deployment_status:

jobs:
  smoke-test:
    if: github.event.deployment_status.state == 'success'
    uses: MagnumMax/tecor/.github/workflows/reusable_smoke_test.yml@main
    with:
      project_name: "fast-lease"
      target_url: "${{ github.event.deployment_status.target_url }}"
    secrets:
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
      NEXT_PUBLIC_SUPABASE_URL: ${{ secrets.NEXT_PUBLIC_SUPABASE_URL }}
      NEXT_PUBLIC_SUPABASE_ANON_KEY: ${{ secrets.NEXT_PUBLIC_SUPABASE_ANON_KEY }}
      SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
      E2E_CLIENT_EMAIL: ${{ secrets.E2E_CLIENT_EMAIL }}
      E2E_CLIENT_PASSWORD: ${{ secrets.E2E_CLIENT_PASSWORD }}
      E2E_OPS_EMAIL: ${{ secrets.E2E_OPS_EMAIL }}
      E2E_OPS_PASSWORD: ${{ secrets.E2E_OPS_PASSWORD }}
