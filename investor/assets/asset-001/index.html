<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fast Lease — Актив R1T-2204</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <script>tailwind.config = { theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } } };</script>
  <link rel="stylesheet" href="../../../assets/style.css" />
</head>
<body class="bg-slate-50 font-sans text-slate-900">
  <div class="min-h-screen lg:flex">
    <aside id="sidebar" class="hidden w-72 border-r border-slate-200 bg-white lg:flex"></aside>
    <div class="flex-1">
      <header id="page-header" class="border-b border-slate-200 bg-white/80 px-6 py-5 backdrop-blur"></header>
      <main class="bg-slate-50">
        <div class="mx-auto w-full max-w-6xl lg:ml-0 lg:mr-auto px-6 py-8 space-y-6">
          <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
            <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
              <div>
                <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Актив</p>
                <h1 class="mt-2 text-2xl font-semibold text-slate-900">Bentley Continental GT · VIN R1T-2204</h1>
                <p class="text-sm text-slate-500">Дата покупки — 10 ноября 2024. Эксплуатация в регионе Москва.</p>
              </div>
              <span class="badge badge-success">В эксплуатации</span>
            </div>
            <div class="mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
              <article class="rounded-xl bg-slate-50/80 p-4">
                <p class="text-xs uppercase tracking-wide text-slate-400">Инвестировано</p>
                <p class="mt-2 text-lg font-semibold text-slate-900" id="asset-invested">—</p>
              </article>
              <article class="rounded-xl bg-slate-50/80 p-4">
                <p class="text-xs uppercase tracking-wide text-slate-400">Получено выплат</p>
                <p class="mt-2 text-lg font-semibold text-slate-900" id="asset-paid">—</p>
              </article>
              <article class="rounded-xl bg-slate-50/80 p-4">
                <p class="text-xs uppercase tracking-wide text-slate-400">IRR</p>
                <p class="mt-2 text-lg font-semibold text-slate-900">10.4%</p>
              </article>
              <article class="rounded-xl bg-slate-50/80 p-4">
                <p class="text-xs uppercase tracking-wide text-slate-400">Риск-профиль</p>
                <p class="mt-2 text-lg font-semibold text-emerald-600">Низкий</p>
              </article>
            </div>
          </section>

          <section class="grid gap-6 lg:grid-cols-[2fr_1fr]">
            <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Финансовая динамика</p>
                  <h2 class="mt-2 text-xl font-semibold text-slate-900">Платежи и остаток</h2>
                </div>
              </div>
              <canvas id="asset-chart" height="260" class="mt-6"></canvas>
            </article>

            <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
              <h2 class="text-sm font-semibold text-slate-800">Состояние автомобиля</h2>
              <ul class="mt-4 space-y-3 text-sm text-slate-600">
                <li class="flex items-center justify-between">
                  Пробег
                  <span class="font-semibold text-slate-900">24 100 км</span>
                </li>
                <li class="flex items-center justify-between">
                  Последнее ТО
                  <span class="font-semibold text-slate-900">12 янв 2025</span>
                </li>
                <li class="flex items-center justify-between">
                  Страхование
                  <span class="badge badge-success">Активно</span>
                </li>
              </ul>
              <div class="mt-5 rounded-xl bg-slate-100/60 px-4 py-3 text-xs text-slate-600">
                <p>Телематика сигнализирует об экономичной езде. Потенциальный износ батареи — 3%.</p>
              </div>
            </article>
          </section>

          <section class="grid gap-6 lg:grid-cols-2">
            <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
              <h2 class="text-sm font-semibold text-slate-800">Текущая сделка</h2>
              <dl class="mt-3 space-y-3 text-sm text-slate-600">
                <div class="flex justify-between"><dt>Клиент</dt><dd>Максим Кузьмин</dd></div>
                <div class="flex justify-between"><dt>Статус</dt><dd><span class="badge badge-success">Активна</span></dd></div>
                <div class="flex justify-between"><dt>Следующий платёж</dt><dd>15 ноября 2025 · AED 4 400</dd></div>
                <div class="flex justify-between"><dt>Остаток выкупа</dt><dd>AED 179 550</dd></div>
              </dl>
            </article>

            <article class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
              <h2 class="text-sm font-semibold text-slate-800">История обслуживания</h2>
              <ul id="service-history" class="mt-4 space-y-3 text-sm"></ul>
            </article>
          </section>
        </div>
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script type="module">
    async function getShared(basePath) {
      
      const sharedMod = await import(`${basePath}/shared.js`);
      return { ...sharedMod };
    }

    const shared = await getShared('../../../assets');
    const { mountSidebar, mountHeader, applyIcons, formatCurrency, formatDate } = shared;
    const { investorNav } = shared;

    const basePath = '../../..';
    mountSidebar({ containerId: 'sidebar', role: 'Инвестор', items: investorNav, activePath: '/investor/portfolio/index.html', basePath });

    mountHeader({
      containerId: 'page-header',
      title: 'Актив R1T-2204',
      breadcrumbs: ['Инвестор', 'Портфель', 'Bentley Continental GT'],
      basePath,
    });

    document.getElementById('asset-invested').textContent = formatCurrency(301000, 'AED');
    document.getElementById('asset-paid').textContent = formatCurrency(45600, 'AED');

    new Chart(document.getElementById('asset-chart'), {
      type: 'line',
      data: {
        labels: ['Ноя', 'Дек', 'Янв', 'Ноя', 'Дек'],
        datasets: [
          {
            label: 'Начислено',
            data: [580, 610, 640, 670, 700],
            borderColor: '#1d4ed8',
            backgroundColor: 'rgba(29, 78, 216, 0.1)',
            fill: true,
            tension: 0.4,
          },
          {
            label: 'Выплачено',
            data: [580, 606, 640, 670, 700],
            borderColor: '#cbd5f5',
            tension: 0.4,
          },
        ],
      },
      options: {
        plugins: { legend: { position: 'bottom' } },
        scales: { y: { beginAtZero: false } },
      },
    });

    const serviceHistory = [
      { date: '2025-01-12', note: 'Плановое ТО у дилера Rivian', status: 'Выполнено' },
      { date: '2024-12-05', note: 'Замена фильтров салона', status: 'Выполнено' },
      { date: '2024-11-18', note: 'Диагностика тормозной системы', status: 'Требует контроля' },
    ];

    document.getElementById('service-history').innerHTML = serviceHistory
      .map(
        (item) => `
        <li class="flex items-start justify-between gap-3 rounded-xl border border-slate-200 px-4 py-3">
          <div>
            <p class="text-sm font-medium text-slate-900">${item.note}</p>
            <p class="text-xs text-slate-500">${formatDate(item.date)}</p>
          </div>
          <span class="badge ${item.status === 'Выполнено' ? 'badge-success' : 'badge-warning'}">${item.status}</span>
        </li>
      `
      )
      .join('');

    applyIcons();
  </script>
</body>
</html>
