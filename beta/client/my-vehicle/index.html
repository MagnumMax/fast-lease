<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dubai Fast Lease â€” My Vehicle</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <script>
    tailwind.config = { theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } } };
  </script>
  <link rel="stylesheet" href="../../assets/style.css" />
</head>
<body class="bg-slate-50 font-sans text-slate-900">
  <div class="min-h-screen lg:flex">
    <aside id="sidebar" class="hidden w-72 border-r border-slate-200 bg-white lg:flex"></aside>
    <div class="flex-1">
      <header id="page-header" class="border-b border-slate-200 bg-white/80 px-6 py-5 backdrop-blur"></header>
      <main class="bg-slate-50">
        <div class="mx-auto flex w-full max-w-6xl flex-col gap-6 lg:ml-0 lg:mr-auto">
          <!-- Vehicle overview -->
          <div id="vehicle-component-container"></div>

          <!-- Services section -->
          <div id="service-schedule-component-container"></div>
        </div>
      </main>
    </div>
  </div>

  <!-- Mobile Bottom Navigation -->
  <nav id="mobile-bottom-nav" class="mobile-bottom-nav"></nav>

  <!-- Service Photos Modal -->
  <div id="service-photo-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-slate-900/50" data-close-modal></div>
    <div class="fixed inset-0 flex items-center justify-center p-4">
      <div class="w-full max-w-2xl rounded-2xl bg-white shadow-xl border border-slate-200">
        <div class="flex items-center justify-between px-5 py-4 border-b border-slate-200">
          <h3 class="text-sm font-semibold text-slate-900" id="service-modal-title">Upload service photos</h3>
          <button class="text-slate-400 hover:text-slate-600" data-close-modal><i data-lucide="x" class="h-5 w-5"></i></button>
        </div>
        <div class="p-5">
          <p class="text-xs text-slate-500">Upload one photo for each angle</p>
          <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4" id="service-modal-slots">
            <!-- Front -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Front</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="front" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="front"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="front">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
            <!-- Rear -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Rear</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="rear" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="rear"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="rear">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
            <!-- Left side -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Left side</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="left" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="left"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="left">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
            <!-- Right side -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Right side</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="right" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="right"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="right">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
            <!-- Dashboard -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Dashboard</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="dashboard" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="dashboard"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="dashboard">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
            <!-- Service sticker -->
            <div class="rounded-xl border border-slate-200 p-3">
              <p class="text-xs font-medium text-slate-700">Service sticker</p>
              <div class="mt-2 flex items-center gap-3">
                <div class="h-16 w-24 overflow-hidden rounded-lg bg-slate-50 border border-slate-200 flex items-center justify-center">
                  <img data-slot-preview="sticker" class="h-full w-full object-cover hidden" />
                  <i data-lucide="image" class="h-5 w-5 text-slate-400" data-slot-empty="sticker"></i>
                </div>
                <button class="inline-flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-xs font-medium text-slate-600 hover:border-slate-900" data-pick-slot="sticker">
                  <i data-lucide="upload" class="h-4 w-4"></i>Choose photo
                </button>
              </div>
            </div>
          </div>
          <input type="file" accept=".jpg,.jpeg,.png" class="sr-only" id="service-modal-file" />
        </div>
        <div class="flex items-center justify-between gap-3 px-5 py-4 border-t border-slate-200">
          <span class="text-xs text-slate-500">JPG/PNG up to 10MB. All 6 photos are required.</span>
          <div class="flex gap-2">
            <button class="rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 hover:border-slate-900" data-close-modal>Cancel</button>
            <button id="service-modal-save" class="rounded-lg bg-slate-900 text-white px-3 py-2 text-sm font-semibold hover:bg-slate-800">Save</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/lucide@latest"></script>
  <script type="module">
    async function getShared(basePath) {
      const sharedMod = await import(`${basePath}/shared.js`);
      return { ...sharedMod };
    }

    // Import components
    const vehicleComponent = await import('../../components/vehicle-component.js');
    const serviceScheduleComponent = await import('../../components/service-schedule-component.js');

    const shared = await getShared('../../assets');
    const { mountSidebar, mountHeader, applyIcons, formatDate, statusBadge, mountMobileBottomNav } = shared;
    const { clientNav } = shared;

    const basePath = '../..';
    mountSidebar({ containerId: 'sidebar', role: 'Client', items: clientNav, activePath: '/client/my-vehicle/index.html', basePath });

    mountHeader({ containerId: 'page-header', title: 'My Vehicle', breadcrumbs: ['Client', 'Vehicle'], basePath });

    // Mobile bottom navigation
    mountMobileBottomNav({ containerId: 'mobile-bottom-nav', items: clientNav, activePath: '/client/my-vehicle/index.html', basePath });

    // Vehicle data (static example)
    const vehicleData = {
      name: 'Rolls-Royce Cullinan',
      subtitle: 'Lease-to-own program for 36 months. Created on December 12, 2024.',
      image: '../../assets/images/rolls-royce-cullinan.jpg',
      specs: [
        { label: 'Year', value: '2024' },
        { label: 'Engine', value: '6.75L V12' },
        { label: 'Color', value: 'Arctic White' },
        { label: 'VIN', value: 'SAMPLEVIN123456789' },
        { label: 'Mileage', value: '18,420 km' },
        { label: 'Insurance', value: 'Valid until 12.12.2025' },
      ],
    };

    // Mount vehicle component
    vehicleComponent.mountVehicleComponent('vehicle-component-container', {
      title: 'Vehicle',
      heading: vehicleData.name,
      subtitle: vehicleData.subtitle,
      image: vehicleData.image,
      specs: vehicleData.specs
    });

    // Update vehicle data
    vehicleComponent.updateVehicleData(vehicleData.name, vehicleData.subtitle, vehicleData.image, vehicleData.specs);

    // Services data and UI (transferred)
    const services = [
      {
        id: 'insp-2025-01-02',
        name: 'Initial inspection',
        type: 'Inspection',
        dueDate: '2025-01-02',
        mileageDue: null,
        completedAt: '2025-01-02',
        attachments: [{ url: '../../assets/images/rolls-royce-cullinan.jpg' }],
      },
      {
        id: 'to-1-2025-02-20',
        name: 'Maintenance #1 (oil and filters)',
        type: 'Maintenance',
        dueDate: '2025-02-20',
        mileageDue: 20000,
        completedAt: null,
        attachments: [],
      },
      {
        id: 'oil-2025-06-15',
        name: 'Oil and filter change',
        type: 'Maintenance',
        dueDate: '2025-06-15',
        mileageDue: 30000,
        completedAt: null,
        attachments: [],
      },
      {
        id: 'annual-2025-12-12',
        name: 'Annual inspection',
        type: 'Inspection',
        dueDate: '2025-12-12',
        mileageDue: null,
        completedAt: null,
        attachments: [],
      },
    ];



    // Mount service schedule component
    serviceScheduleComponent.mountServiceScheduleComponent('service-schedule-component-container', {
      title: 'Service schedule and confirmations',
      services: services,
      instructions: 'To confirm service, upload 6 photos: front, rear, left and right sides, dashboard, service sticker. JPG/PNG up to 10MB.'
    });

    // Render services using the component
    serviceScheduleComponent.renderServices(services);

    setTimeout(() => { applyIcons(); }, 100);
  </script>
</body>
</html>
